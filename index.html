<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SWAP — Switch With Any Portion</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Background animation canvas -->
  <canvas id="bgCanvas" aria-hidden="true"></canvas>

  <!-- SPLASH -->
  <main id="splash" class="splash">
    <section class="splashLeft" style="background-image:url('https://cdn.shopify.com/s/files/1/0550/0659/3185/files/Screenshot_2025-12-09_at_12.16.42_PM.png?v=1765300609');">
      <div class="splashLeftOverlay"></div>
      <div class="splashLeftInner">
        <div class="ratingRow" aria-label="5 star rating">
          <div class="stars" aria-hidden="true">★★★★★</div>
          <div class="ratingText">Rated 5.0 by early users</div>
        </div>

        <h1 class="heroTitle">SWITCH WITH ANY PORTION</h1>
        <p class="heroSub">
          Precision food swaps at any portion size — database-backed matching with strict tolerance logic.
        </p>

        <div class="poweredBy">
          Powered by <a href="https://monkvee.com" target="_blank" rel="noopener">monkvee.com</a>
        </div>

        <div class="pillRow">
          <div class="pill">Medical-grade exchange logic</div>
          <div class="pill">Strict or Flex mode</div>
          <div class="pill">Portion-aware swaps</div>
        </div>
      </div>
    </section>

    <section class="splashRight">
      <div class="glassCard splashCard">
        <img class="swapLogo" alt="SWAP logo" src="https://cdn.shopify.com/s/files/1/0550/0659/3185/files/Swap_logo_1.jpg?v=1766691390" />

        <h2 class="welcomeTitle">Welcome to SWAP</h2>
        <p class="welcomeSub">
          Tell us the basics once. Then swap foods by portion size, with rules that stay honest.
        </p>

        <div class="apiRow">
          <div id="apiDot" class="dot"></div>
          <div id="apiText" class="apiText">Checking API…</div>
          <button id="apiRetry" class="iconBtn" title="Retry API check" aria-label="Retry API check">↻</button>
        </div>

        <button id="getStartedBtn" class="primaryBtn">Get started</button>
        <button id="demoBtn" class="secondaryBtn">Open demo</button>

        <p class="micro">
          Strict mode: no match = no swaps. Flex mode: ranked best-fit (clearly labeled).
        </p>
      </div>
    </section>
  </main>

  <!-- INTAKE (Wizard) -->
  <section id="intake" class="intake hidden" aria-hidden="true">
    <header class="topBar">
      <div class="brandMini">
        <img alt="SWAP" src="https://cdn.shopify.com/s/files/1/0550/0659/3185/files/Swap_logo_1.jpg?v=1766691390" />
        <div class="brandMiniText">
          <div class="brandMiniName">SWAP</div>
          <div class="brandMiniSub">Switch With Any Portion</div>
        </div>
      </div>
      <div class="topBarRight">
        <button id="skipIntakeBtn" class="ghostBtn">Skip for now</button>
      </div>
    </header>

    <div class="wizardWrap">
      <div class="wizardCard glassCard">
        <div class="wizardHeader">
          <div class="wizardTitle">Quick intake</div>
          <div id="wizardStep" class="wizardStep">Step 1 of 3</div>
        </div>

        <div class="wizardProgress" role="progressbar" aria-valuemin="1" aria-valuemax="3" aria-valuenow="1">
          <div id="wizardProgFill" class="wizardProgFill"></div>
        </div>

        <!-- Step panels -->
        <form id="intakeForm" class="wizardBody">
          <!-- STEP 1 -->
          <div class="stepPanel" data-step="1">
            <div class="grid2">
              <div class="field">
                <label>Height</label>
                <div class="row">
                  <input id="height_cm" type="number" inputmode="decimal" placeholder="cm" min="50" max="250" />
                  <div class="hint">cm</div>
                </div>
              </div>

              <div class="field">
                <label>Weight</label>
                <div class="row">
                  <input id="weight_kg" type="number" inputmode="decimal" placeholder="kg" min="20" max="300" />
                  <div class="hint">kg</div>
                </div>
              </div>

              <div class="field">
                <label>Age</label>
                <input id="age" type="number" inputmode="numeric" placeholder="e.g., 32" min="10" max="120" />
              </div>

              <div class="field">
                <label>Sex</label>
                <select id="sex">
                  <option value="">Select…</option>
                  <option value="female">Female</option>
                  <option value="male">Male</option>
                </select>
              </div>
            </div>
          </div>

          <!-- STEP 2 -->
          <div class="stepPanel hidden" data-step="2">
            <div class="grid2">
              <div class="field">
                <label>Activity</label>
                <select id="activity">
                  <option value="">Select…</option>
                  <option value="sedentary">Sedentary</option>
                  <option value="light">Light</option>
                  <option value="moderate">Moderate</option>
                  <option value="active">Active</option>
                  <option value="athlete">Athlete</option>
                </select>
              </div>

              <div class="field">
                <label>Goal</label>
                <select id="goal">
                  <option value="">Select…</option>
                  <option value="fat_loss">Fat loss</option>
                  <option value="maintain">Maintain</option>
                  <option value="muscle_gain">Muscle gain</option>
                </select>
              </div>
            </div>

            <div class="callout">
              We’ll calculate suggested daily calories + macros (you can ignore this and just use swaps).
            </div>

            <div id="targetsPreview" class="targetsPreview hidden"></div>
          </div>

          <!-- STEP 3 -->
          <div class="stepPanel hidden" data-step="3">
            <div class="grid2">
              <div class="field">
                <label>Diet tag (optional)</label>
                <select id="diet">
                  <option value="">None</option>
                  <option value="kosher">Kosher</option>
                  <option value="halal">Halal</option>
                  <option value="vegan">Vegan</option>
                  <option value="vegetarian">Vegetarian</option>
                  <option value="low_carb">Low carb</option>
                  <option value="gluten_free">Gluten free</option>
                </select>
              </div>

              <div class="field">
                <label>Medical focus (optional)</label>
                <select id="medical">
                  <option value="">None</option>
                  <option value="diabetes">Diabetes / blood sugar</option>
                  <option value="prediabetes">Prediabetes</option>
                  <option value="hypertension">Hypertension</option>
                </select>
              </div>

              <div class="field fieldFull">
                <label>Allergies (comma-separated, optional)</label>
                <input id="allergies" type="text" placeholder="e.g., dairy, gluten, soy" />
              </div>
            </div>

            <div class="callout subtle">
              Allergies + diet filters will be applied when searching swaps.
            </div>
          </div>

          <div class="wizardFooter">
            <button id="backBtn" type="button" class="ghostBtn">Back</button>
            <div class="wizardFooterRight">
              <button id="nextBtn" type="button" class="primaryBtn">Continue</button>
            </div>
          </div>
        </form>
      </div>

      <div class="wizardSide glassCard">
        <div class="sideTitle">What you’ll do next</div>
        <div class="sideList">
          <div class="sideItem"><span class="sideDot"></span> Search a food from your database</div>
          <div class="sideItem"><span class="sideDot"></span> Enter portion size (g/oz/serving)</div>
          <div class="sideItem"><span class="sideDot"></span> Get strict or best-fit swaps</div>
        </div>
      </div>
    </div>
  </section>

  <!-- APP (HUD / Dashboard) -->
  <section id="app" class="app hidden" aria-hidden="true">
    <header class="topBar">
      <div class="brandMini">
        <img alt="SWAP" src="https://cdn.shopify.com/s/files/1/0550/0659/3185/files/Swap_logo_1.jpg?v=1766691390" />
        <div class="brandMiniText">
          <div class="brandMiniName">SWAP</div>
          <div class="brandMiniSub">Switch With Any Portion</div>
        </div>
      </div>

      <div class="topBarRight">
        <div class="apiChip">
          <span id="hudApiDot" class="dot"></span>
          <span id="hudApiText">API</span>
        </div>
        <button id="openProfileBtn" class="ghostBtn">Profile</button>
      </div>
    </header>

    <div class="layout">
      <aside class="sidebar">
        <div class="navTitle">Workspace</div>
        <button class="navItem active" data-view="swapView">Swap Finder</button>
        <button class="navItem" data-view="profileView">Profile</button>

        <div class="sidebarFoot">
          <div class="miniNote">Strict exchange logic • Portion-aware</div>
        </div>
      </aside>

      <main class="content">
        <!-- Swap Finder -->
        <section id="swapView" class="view">
          <div class="gridMain">
            <div class="glassCard cardPad">
              <div class="cardHead">
                <div>
                  <div class="cardTitle">Find a swap</div>
                  <div class="cardSub">Search a food, set portion, choose strict vs flex, get swaps.</div>
                </div>
                <button id="resetSwapBtn" class="ghostBtn">Reset</button>
              </div>

              <div class="formGrid">
                <div class="field fieldFull">
                  <label>Food</label>
                  <div class="searchWrap">
                    <input id="foodSearch" type="text" placeholder="Start typing (e.g., chicken, oats, greek yogurt)…" autocomplete="off" />
                    <div id="searchDrop" class="searchDrop hidden" role="listbox" aria-label="Food search results"></div>
                  </div>
                  <div id="pickedFoodHint" class="hintText hidden"></div>
                </div>

                <div class="field">
                  <label>Portion</label>
                  <input id="portion" type="number" inputmode="decimal" placeholder="e.g., 140" min="0" step="0.1" />
                </div>

                <div class="field">
                  <label>Unit</label>
                  <select id="unit">
                    <option value="g">g</option>
                    <option value="oz">oz</option>
                    <option value="serving">serving</option>
                  </select>
                </div>

                <div class="field">
                  <label>Calories tolerance</label>
                  <select id="calTol">
                    <option value="0.02">±2%</option>
                    <option value="0.05" selected>±5%</option>
                    <option value="0.08">±8%</option>
                    <option value="0.10">±10%</option>
                  </select>
                </div>

                <div class="field">
                  <label>Macro tolerance</label>
                  <select id="macroTol">
                    <option value="0.05">±5%</option>
                    <option value="0.10" selected>±10%</option>
                    <option value="0.15">±15%</option>
                    <option value="0.20">±20%</option>
                  </select>
                </div>

                <div class="field fieldFull">
                  <div class="toggles">
                    <label class="toggle">
                      <input id="sameGroup" type="checkbox" checked />
                      <span>Same group only</span>
                    </label>
                    <label class="toggle">
                      <input id="flex" type="checkbox" />
                      <span>Flex mode (best-fit)</span>
                    </label>
                  </div>
                </div>
              </div>

              <button id="swapBtn" class="primaryBtn full">Get swaps</button>

              <div id="swapError" class="errorBox hidden"></div>
            </div>

            <div class="glassCard cardPad">
              <div class="cardTitle">Original vs Swap</div>
              <div class="cardSub">We show honest deltas so you can trust the match.</div>

              <div id="originalBox" class="macroBox muted">
                Pick a food to see the breakdown.
              </div>

              <div class="divider"></div>

              <div id="resultsBox" class="resultsBox">
                <div class="emptyState">
                  <div class="emptyTitle">No swaps yet</div>
                  <div class="emptySub">Search a food, enter portion, then click “Get swaps”.</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Profile -->
        <section id="profileView" class="view hidden">
          <div class="glassCard cardPad">
            <div class="cardHead">
              <div>
                <div class="cardTitle">Your profile</div>
                <div class="cardSub">Used for targets + preference filtering (optional).</div>
              </div>
              <button id="editIntakeBtn" class="ghostBtn">Edit intake</button>
            </div>

            <div id="profileBox" class="profileBox"></div>
          </div>
        </section>
      </main>
    </div>

    <!-- Mobile bottom nav -->
    <nav class="bottomNav">
      <button class="bnItem active" data-view="swapView">Swap</button>
      <button class="bnItem" data-view="profileView">Profile</button>
    </nav>

    <!-- Simple modal -->
    <div id="modal" class="modal hidden" aria-hidden="true">
      <div class="modalBackdrop"></div>
      <div class="modalCard glassCard">
        <div class="modalHead">
          <div id="modalTitle" class="modalTitle">Title</div>
          <button id="modalClose" class="iconBtn" aria-label="Close">✕</button>
        </div>
        <div id="modalBody" class="modalBody"></div>
      </div>
    </div>
  </section>

  <script src="app.js"></script>
</body>
</html>
