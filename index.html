<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SWAP — Switch With Any Portion</title>
  <meta name="description" content="Switch With Any Portion — deterministic food swaps at any portion size." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <canvas id="bg"></canvas>

  <!-- Splash -->
  <section id="splash" class="splash">
    <div class="splashCard">
      <div class="splashTop">
        <img class="logo" alt="SWAP" src="https://cdn.shopify.com/s/files/1/0550/0659/3185/files/Swap_logo_1.jpg?v=1766691390" />
        <div class="apiPill" title="API connectivity">
          <span id="apiDot" class="dot warn"></span>
          <span id="apiText">API: checking…</span>
          <button id="apiRetry" class="iconBtn" aria-label="Retry API check">↻</button>
        </div>
      </div>

      <h1 class="heroTitle">Switch With Any Portion.</h1>
      <p class="heroSub">
        Deterministic nutrition math + database-backed matching.
        Strict mode enforces calories & macros within ±2–5% (or your selected tolerance).
      </p>

      <div class="featureRow">
        <div class="feature">
          <div class="kicker">Medical-grade logic</div>
          <div class="featureTitle">Exchange-style swaps</div>
          <div class="featureBody">No “close enough” guessing in strict mode.</div>
        </div>
        <div class="feature">
          <div class="kicker">Holistic layer</div>
          <div class="featureTitle">Satiety + digestion hints</div>
          <div class="featureBody">Optional overlays (doesn’t change deterministic swaps).</div>
        </div>
        <div class="feature">
          <div class="kicker">Fast</div>
          <div class="featureTitle">Search → portion → swaps</div>
          <div class="featureBody">Instant results with demo DB; upgrades with your API.</div>
        </div>
      </div>

      <div class="ctaRow">
        <button id="enterBtn" class="btn primary">Enter now</button>
        <button id="demoBtn" class="btn ghost">Open demo</button>
      </div>

      <div class="tinyNote">
        Strict: no match = no swaps. Flex: ranked best-fit (clearly labeled).
      </div>
    </div>
  </section>

  <!-- HUD -->
  <section id="hud" class="hud hidden">
    <aside class="nav">
      <div class="navTop">
        <img class="navLogo" alt="SWAP" src="https://cdn.shopify.com/s/files/1/0550/0659/3185/files/Swap_logo_1.jpg?v=1766691390" />
        <div class="navMeta">
          <div class="navName">SWAP</div>
          <div class="navSub">Switch With Any Portion</div>
        </div>
      </div>

      <div class="navApi">
        <span id="apiDot2" class="dot warn"></span>
        <span id="apiText2">API: checking…</span>
        <button id="apiRetry2" class="iconBtn" aria-label="Retry API check">↻</button>
      </div>

      <button class="navItem active" data-tab="swap">Swap Engine</button>
      <button class="navItem" data-tab="targets">Targets</button>
      <button class="navItem" data-tab="notes">Notes</button>

      <div class="navFooter">
        <div class="pill">Strict swaps: deterministic</div>
        <div class="pill">Powered by your Foods DB</div>
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <div>
          <div class="pageTitle" id="pageTitle">Swap Engine</div>
          <div class="pageSub">Pick a food, enter a portion, get precision swaps.</div>
        </div>
        <div class="topActions">
          <button id="backToSplash" class="btn small ghost">Splash</button>
        </div>
      </header>

      <!-- Swap tab -->
      <section class="panel" data-panel="swap">
        <div class="grid2">
          <div class="card">
            <div class="cardTitle">Input</div>

            <label class="field">
              <span>Food search</span>
              <input id="q" type="text" placeholder="e.g., chicken breast" autocomplete="off" />
              <div id="suggest" class="suggest hidden"></div>
            </label>

            <div class="row">
              <label class="field">
                <span>Portion</span>
                <input id="portion" type="number" step="0.1" value="1" />
              </label>
              <label class="field">
                <span>Unit</span>
                <select id="unit">
                  <option value="g">g</option>
                  <option value="oz">oz</option>
                  <option value="serving">serving</option>
                  <option value="piece">piece</option>
                </select>
              </label>
            </div>

            <div class="row">
              <label class="field">
                <span>Cal tolerance</span>
                <select id="calTol">
                  <option value="2">±2%</option>
                  <option value="3">±3%</option>
                  <option value="5" selected>±5%</option>
                  <option value="8">±8%</option>
                  <option value="10">±10%</option>
                </select>
              </label>
              <label class="field">
                <span>Macro tolerance</span>
                <select id="macroTol">
                  <option value="5">±5%</option>
                  <option value="8">±8%</option>
                  <option value="10" selected>±10%</option>
                  <option value="15">±15%</option>
                  <option value="20">±20%</option>
                </select>
              </label>
            </div>

            <div class="row">
              <label class="field">
                <span>Mode</span>
                <select id="mode">
                  <option value="strict" selected>Strict</option>
                  <option value="flex">Flex</option>
                </select>
              </label>
              <button id="findBtn" class="btn primary grow">Find swaps</button>
            </div>

            <div class="divider"></div>
            <div id="selected" class="mini hidden"></div>
            <div id="targetBox" class="mini hidden"></div>
          </div>

          <div class="card">
            <div class="cardTitle">Results</div>
            <div id="results" class="results">
              <div class="empty">
                Search a food, set a portion, then hit <b>Find swaps</b>.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Targets tab (MVP placeholder) -->
      <section class="panel hidden" data-panel="targets">
        <div class="card">
          <div class="cardTitle">Targets (MVP)</div>
          <div class="muted">
            Keep this tab for your Mifflin-St Jeor + macro targets module.
            Your swap engine is independent and deterministic.
          </div>
        </div>
      </section>

      <!-- Notes tab -->
      <section class="panel hidden" data-panel="notes">
        <div class="card">
          <div class="cardTitle">Notes</div>
          <div class="muted">
            Strict swaps only use: calories + protein + carbs + fat (per gram) and portion conversion (units_json).
            Optional scoring columns (GI/GL/satiety/insulin) can be blank without breaking strict swap correctness.
          </div>
        </div>
      </section>
    </main>
  </section>

  <div id="toast" class="toast hidden"></div>

  <script src="./app.js"></script>
</body>
</html>
